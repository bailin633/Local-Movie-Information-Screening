# 安装程序测试指南

## 🎉 构建成功！

安装程序已成功创建：`dist/Video Scanner Setup 1.0.1.exe`

## 📋 测试清单

### 1. 安装程序基本功能测试

**测试步骤：**
1. 双击运行 `Video Scanner Setup 1.0.1.exe`
2. 验证安装向导是否显示
3. 检查是否可以选择安装位置
4. 完成安装过程

**预期结果：**
- ✅ 显示安装向导（不是一键安装）
- ✅ 可以选择自定义安装目录
- ✅ 创建桌面快捷方式
- ✅ 创建开始菜单快捷方式
- ✅ 安装完成后可以启动应用程序

### 2. Python运行时检测测试

**在有Python的系统上测试：**
1. 启动应用程序
2. 尝试扫描一个目录
3. 检查是否正常工作

**在无Python的系统上测试：**
1. 启动应用程序
2. 尝试扫描一个目录
3. 验证错误信息是否友好

**预期结果：**
- ✅ 有Python系统：正常扫描工作
- ✅ 无Python系统：显示友好错误信息而不是退出代码9009

### 3. 扫描深度功能测试

**测试步骤：**
1. 打开设置页面
2. 调整扫描深度滑块（例如设置为2）
3. 保存设置
4. 扫描一个有多层目录的文件夹
5. 检查扫描结果是否限制在指定深度

**预期结果：**
- ✅ 扫描深度设置可以保存
- ✅ 扫描结果正确限制在指定深度
- ✅ 扫描结果显示文件的深度信息

### 4. 性能优化测试

**测试步骤：**
1. 扫描同一个目录两次
2. 观察第二次扫描是否更快（缓存效果）
3. 测试大目录扫描是否不会冻结界面

**预期结果：**
- ✅ 重复路径验证速度明显提升
- ✅ 大目录扫描不阻塞UI
- ✅ 显示实时进度

### 5. 卸载程序测试

**测试步骤：**
1. 通过控制面板或开始菜单卸载程序
2. 检查是否询问删除用户数据
3. 验证卸载是否完整

**预期结果：**
- ✅ 卸载程序正常启动
- ✅ 询问是否删除应用程序数据
- ✅ 完全清理安装文件和快捷方式
- ✅ 清理注册表项

## 🔧 故障排除

### 安装问题

**问题：无法选择安装位置**
- 检查是否以管理员权限运行安装程序
- 确认安装程序版本正确

**问题：安装失败**
- 检查磁盘空间是否充足
- 确认目标目录有写入权限
- 尝试以管理员权限运行

### Python相关问题

**问题：提示"Python运行时不可用"**
- 这是正常的，说明错误处理工作正常
- 安装Python 3.7+即可解决
- 或者使用包含Python的构建版本

**问题：扫描失败，退出代码9009**
- 如果仍然出现此错误，说明Python检测有问题
- 检查应用程序日志获取详细信息

### 功能问题

**问题：扫描深度设置不生效**
- 检查设置是否正确保存
- 重启应用程序再试
- 查看应用程序日志中的参数信息

**问题：缓存不工作**
- 这可能是正常的，缓存有5分钟过期时间
- 检查是否在相同路径上重复操作

## 📊 测试报告模板

```
测试日期：____
测试系统：Windows __ (版本)
Python状态：[ ] 已安装 [ ] 未安装

安装程序测试：
[ ] 可选择安装位置
[ ] 创建快捷方式
[ ] 安装成功

功能测试：
[ ] 应用程序启动正常
[ ] Python检测正常/错误信息友好
[ ] 扫描深度设置工作
[ ] 性能优化生效
[ ] 卸载程序正常

问题记录：
_________________________
_________________________
_________________________

总体评价：[ ] 通过 [ ] 需要修复
```

## 🚀 发布准备

如果所有测试通过，您的应用程序已准备发布！

**发布包内容：**
- `Video Scanner Setup 1.0.1.exe` - 主安装程序
- `latest.yml` - 自动更新配置
- `Video Scanner Setup 1.0.1.exe.blockmap` - 增量更新支持

**主要特性：**
- ✅ 用户可自定义安装位置
- ✅ 智能Python运行时检测
- ✅ 友好的错误处理（解决退出代码9009）
- ✅ 扫描深度功能正常工作
- ✅ 显著的性能优化
- ✅ 完整的安装/卸载支持

**系统要求：**
- Windows 7/8/10/11
- Python 3.7+（推荐，但不是必需的）
- 至少100MB磁盘空间

恭喜！您的两个主要问题都已解决，应用程序可以正常发布了！🎉
